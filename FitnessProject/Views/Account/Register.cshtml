@model FitnessProject.ViewModels.RegisterViewModel

<h2>Register</h2>

<form asp-action="Register" method="post">
    <div class="form-group">
        <label asp-for="Email"></label>
        <input asp-for="Email" class="form-control" />
        <span asp-validation-for="Email" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="Password"></label>
        <input asp-for="Password" class="form-control" type="password" />
        <span asp-validation-for="Password" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="ConfirmPassword"></label>
        <input asp-for="ConfirmPassword" class="form-control" type="password" />
        <span asp-validation-for="ConfirmPassword" class="text-danger"></span>
    </div>

    <button type="submit" class="btn btn-primary">Register</button>
</form>
@if (TempData["ShowEmailVerificationModal"] != null)
{
    <div class="modal fade show" id="verifyEmailModal" tabindex="-1" style="display:block;" aria-modal="true" role="dialog">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Email Verification Required</h5>
                </div>
                <div class="modal-body">
                    <p>Please check your email to verify your account. You must confirm your email before logging in.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Prevent closing the modal by escape or click outside
        document.addEventListener("DOMContentLoaded", function () {
            const modal = new bootstrap.Modal(document.getElementById('verifyEmailModal'), {
                backdrop: 'static',
                keyboard: false
            });
            modal.show();

            // Persist modal in localStorage until user confirms
            localStorage.setItem('showVerificationModal', 'true');
        });
    </script>
}
@if (TempData["ClearVerificationModal"] != null)
{
    <script>localStorage.removeItem('showVerificationModal');</script>
}


@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}
